<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <title>Document</title>
</head>

<body class="bg-black text-white box-border">
    <div class="attack_animate">
        <img src="wzoQxz.gif" alt="">
        <!-- <video src="Sword Battle.mp4"></video> -->
    </div>
    <div class="defense_animate">‚ù§Ô∏è</div>
    <div id="popup" class=" fixed inset-0 z-10 hidden flex flex-col items-center justify-center p-4 backdrop-blur-sm">
        <div class=" bg-cyan-800/70 shadow-xl rounded-xl">
            <h2 class="text-white/80 font-bold text 2xl text-center my-2">Choose mode:</h2>
            <div class="container mx-auto flex gap-8 p-4">
                <button id="attack"
                    class="bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 rounded-lg font-bold transition transform hover:scale-105 flex items-center gap-2 shadow-lg p-2">‚öîÔ∏è Attack</button>
                <button id="defense" class="bg-gradient-to-l bg-green-600 to-green-700 hover:from-green-500 hover:to-green-600 rounded-lg p-2 transition transform hover:scale-105">üõ°Ô∏è Defence</button>
            </div>
        </div>

    </div>
    <header class="flex justify-between items-center p-3">
        <div class="flex items-center gap-8">
            <a href="index.html"> <img src="images/elementara.png" class=" w-28 sm:w-32" alt=""></a>
            <button
                class="btn-primary text-sm h-8 relative px-10 bg-[linear-gradient(to_right,_#8430E2_0%,_#664BE2_50%,_#5658E2_75%,_#4765E2_100%)] rounded-full transition duration-300 ease-in-out transform hover:scale-105">YOUR
                TURN</button>
            <p>Turn: <span class="text-cyan-600"></span></p>
        </div>
        <div class="flex gap-8">
            <div class="flex items-center gap-6 text-orange-400">
                <p>OPP HP:</p>
                <span id="opp_hp" class="font-bold text-xl ">200</span>
            </div>
            <div class="flex items-center gap-6 text-cyan-400">
                <p>YOUR HP:</p>
                <span id="your_hp" class="font-bold text-xl">200</span>
            </div>
        </div>
        <button id="endTurn"
            class="btn-primary px-4 py-2 h-10 bg-red-600 rounded-lg transition duration-300 ease-in-out transform hover:scale-105">END
            TURN</button>
    </header>

    <main class="flex h-[90]">
        <aside class="bg-[#171C37]/60 border-r-2 border-purple-900 w-60 h-[90vh] overflow-auto" id="deck_side">
            <section id="deck-cards" class="flex flex-col justify-center gap-4 p-1">
                <!-- <button id="drawCard" class="mt-4 btn-primary text-[16px] h-10 relative bg-[linear-gradient(to_right,_#8430E2_0%,_#664BE2_50%,_#5658E2_75%,_#4765E2_100%)] rounded-full transition duration-300 ease-in-out transform hover:scale-105">Draw Card</button> -->
                <h2 class="text-center text-purple-400 font-bold py-2">My Deck <span id="deck_cpt">6</span></h2>

            </section>
        </aside>
        <section class="flex-1 py-5 px-16 flex flex-col gap-3">

            <h3 class="text-center font-bold text-xs mb-2 text-orange">OPPONENT ZONE</h3>

            <div class="bg-gradient-to-br from-red-700/30 to-transparent border border-orange-800 rounded-xl py-3 px-8 mx-16 flex-1">
                <div class="h-full flex flex-col gap-2">

                    <div id="opponentCard" class="flex-1 grid grid-cols-5 gap-2">
                        <div
                            class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all">
                        </div>
                        <div
                            class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all">
                        </div>
                        <div
                            class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all">
                        </div>
                        <div
                            class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all">
                        </div>
                        <div
                            class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all">
                        </div>
                    </div>

                </div>
            </div>

            <div class="bg-gradient-to-tl from-cyan-700/30 to-transparent border border-cyan-800 rounded-xl p-3 flex-1 py-3 px-8 mx-16">
                <div class="h-full flex flex-col gap-2">

                    <div class="flex-1 grid grid-cols-5 gap-2">
                        <div class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all"
                            ondragover="dragCard(event)"></div>
                        <div class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all"
                            ondragover="dragCard(event)"> </div>
                        <div class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all"
                            ondragover="dragCard(event)"> </div>
                        <div class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all"
                            ondragover="dragCard(event)"> </div>
                        <div class="border-2 border-dashed border-gray-600 bg-black/50 rounded-lg relative transition-all"
                            ondragover="dragCard(event)"> </div>
                    </div>

                </div>
            </div>

            </div>
            <h3 class="text-center font-bold text-xs text-ciel">My ZONE</h3>


            <div id="My_Hand"
                class="flex gap-4 justify-center bg-[#171C37]/60 border-2 border-cyan-500 rounded-lg h-[22vh] p-4">

            </div>
        </section>
    </main>

    <script>
        const decks = JSON.parse(localStorage.getItem('deck')) || []
        const playCards = [...decks];
        const cards = [
            { id: 1, name: "Voltarax", faction: "lightning", type: "creature", rarity: "legendary", edition: "1/1", attack: 10, defense: 8, speed: 9, price: 10000, image: "/images/4.png", description: "The ancient guardian of storms, master of thunder and lightning" },
            { id: 2, name: "Ignothar", faction: "fire", type: "creature", rarity: "legendary", edition: "1/1", attack: 12, defense: 7, speed: 6, price: 12000, image: "/images/fire1.png", description: "The incandescent titan, embodiment of rage and destruction" },
            { id: 3, name: "Glacior", faction: "ice", type: "creature", rarity: "legendary", edition: "1/1", attack: 8, defense: 12, speed: 7, price: 11000, image: "/images/ice1.png", description: "The eternal paladin, guardian of frozen eternity" },
            { id: 4, name: "Storm Assassin", faction: "lightning", type: "creature", rarity: "epic", edition: "1/10", attack: 7, defense: 4, speed: 10, price: 2500, image: "images/light1.jpg", description: "Silent as shadow, fast as lightning" },
            { id: 5, name: "Lava Colossus", faction: "fire", type: "creature", rarity: "epic", edition: "1/10", attack: 9, defense: 6, speed: 4, price: 2800, image: "images/fire2.png", description: "Walking volcano of pure destruction" },
            { id: 6, name: "Crystalline", faction: "ice", type: "creature", rarity: "epic", edition: "1/10", attack: 6, defense: 9, speed: 5, price: 2600, image: "images/ice2.png", description: "Impenetrable guardian of the frozen realm" },
            { id: 7, name: "Thunder Dragon", faction: "lightning", type: "creature", rarity: "epic", edition: "1/10", attack: 8, defense: 5, speed: 9, price: 2700, image: "images/light2.jpg", description: "Soaring through storms with devastating power" },
            { id: 8, name: "Inferno Beast", faction: "fire", type: "creature", rarity: "epic", edition: "1/10", attack: 10, defense: 5, speed: 5, price: 2900, image: "images/fire3.png", description: "Unleashed fury from the depths of hell" },
            { id: 9, name: "Spark Mage", faction: "lightning", type: "creature", rarity: "rare", edition: "1/100", attack: 5, defense: 3, speed: 8, price: 800, image: "images/light3.png", description: "Master of electrical manipulation" },
            { id: 10, name: "Flame Warrior", faction: "fire", type: "creature", rarity: "rare", edition: "1/100", attack: 6, defense: 4, speed: 5, price: 850, image: "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400&h=250&fit=crop", description: "Forged in the heart of volcanoes" },
            { id: 11, name: "Frost Knight", faction: "ice", type: "creature", rarity: "rare", edition: "1/100", attack: 4, defense: 7, speed: 6, price: 820, image: "https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=400&h=250&fit=crop", description: "Noble protector of the frozen wastes" },
            { id: 12, name: "Lightning Strike", faction: "lightning", type: "spell", rarity: "rare", edition: "1/100", attack: 0, defense: 0, speed: 0, price: 600, image: "https://images.unsplash.com/photo-1475274047050-1d0c0975c63e?w=400&h=250&fit=crop", description: "Deal 5 damage to any target" }
        ];
        let turn = 'player'
        let play = 1
        let player_hp = 200
        let opp_hp = 200



        function displayDeck(deck) {
            const container = document.getElementById('deck-cards')
            container.innerHTML = ""

            deck.forEach(card => {
                const elmnt = document.createElement('div')
                elmnt.className = `bg-gray-800 border-2 card-${card.faction} rounded-lg p-2 cursor-pointer transition`
                elmnt.innerHTML = `
                    <img src="${card.image}" class="w-full h-21 object-cover rounded mb-1">
                    <p class="text-[9px] font-bold text-center">${card.name}</p>
                    <div class="flex justify-around text-[10px] text-gray-400 mt-1">
                        <span>‚öîÔ∏è${card.attack}</span>
                        <span>üõ°Ô∏è${card.defense}</span>
                    </div>
                    `;
                container.appendChild(elmnt)
                elmnt.addEventListener('click', () => {
                 
                    const hand = document.getElementById('My_Hand')
                    let current_cards = hand.children.length
                    console.log(current_cards)

                    if (current_cards < 5) {

                        // hand.innerHTML=""
                        const elment = document.createElement('div')
                        elment.addEventListener("dragstart", () => {
                            elment.classList.add("dragging")
                        })
                        elment.addEventListener("dragend", () => {
                            elment.classList.remove("dragging")
                        })
                        elment.className = `h-full w-32 bg-gray-900 border-2 border-cyan-500 rounded-lg p-2 transiton`
                        elment.innerHTML = `
                           <div class="w-full h-full rounded-lg bg-cover bg-center relative cursor-pointer flex flex-col justify-end" 
                                 style="background-image: url('${card.image}');">
                                <div class="bg-gradient-to-t from-black/90 via-black/70 to-transparent p-2 rounded-b-lg">
                                    <p class="text-[9px] font-bold text-center text-white mb-1">${card.name}</p>
                                    <div class="flex justify-around text-[10px] text-gray-200">
                                        <span>‚öîÔ∏è${card.attack}</span>
                                        <span>üõ°Ô∏è${card.defense}</span>
                                    </div>
                                </div>
                            </div>
                    `
                      // <img src="${card.image}" class="w-full h-20 rounded mb-1">
                        // <p class="text-[9px] font-bold text-center">${card.name}</p>
                        // <div class="flex justify-around text-[10px] text-gray-400 ">
                        //     <span>‚öîÔ∏è${card.attack}</span>
                        //     <span>üõ°Ô∏è${card.defense}</span>
                        // </div>
                    card.quantity -= 1

                        hand.appendChild(elment)
                        displayDeck(deck)
                        if (card.quantity <= 1) {
                            // alert(`You have no more ${card.name} left in your deck`)
                            deck = deck.filter(f => f.id !== card.id)
                            displayDeck(deck)
                            return
                        }
                    } else {
                        alert('Five Cart Max')
                    }

                })
            })
        }

        // function dragoverHandler(ev) {
        //     ev.preventDefault();

        //     const draggingElement = document.querySelector(".dragging");
        //     console.log(draggingElement)
        //     const dropZone = ev.currentTarget;
        //     if(turn=='defence'){
        //         return
        //     }
        //         if (dropZone.children.length === 0) {
        //             const popup = document.getElementById('popup')
        //             const attack = document.getElementById('attack')
        //             const defense = document.getElementById('defense')
        //             popup.classList.remove('hidden')
        //             popup.classList.add('flex')

        //             attack.onclick = () => {
        //                 popup.classList.remove('flex')
        //                 popup.classList.add('hidden')
        //                 if (draggingElement && dropZone) {
        //                     draggingElement.classList.add('card-drop-animation', 'w-[100%]')
        //                     // console.log(dra)
        //                     const wave = document.createElement('div')
        //                     wave.className = 'shockwave-effect'
        //                     dropZone.appendChild(wave)
        //                     dropZone.appendChild(draggingElement);

        //                     setTimeout(() => wave.remove(), 1000)
        //                     let attack__1 = document.querySelector('.attack_animate')
        //                     attack__1.classList.add('active')
        //                     setTimeout(() => attack__1.classList.remove('active'), 1000)
        //                     turn='defence'
        //                 }
        //             }
        //             defense.onclick = () => {
        //                 popup.classList.remove('flex')
        //                 popup.classList.add('hidden')
        //                 if (draggingElement && dropZone) {
        //                     const wave = document.createElement('div')
        //                     wave.className = 'shockwave-effect'
        //                     dropZone.appendChild(wave)
        //                     draggingElement.classList.add('w-[100%]','card-drop-animation')
        //                     // draggingElement.style.rotate = '90deg'
        //                     // draggingElement.classList.add('ml-5')
        //                     dropZone.appendChild(draggingElement);
        //                     dropZone.style.rotate = '90deg'
        //                     turn='defence'
        //                 }
        //             }
        //         }
                
            
        // }
        function dragCard(ev){
            ev.preventDefault()
            if(turn==='defence') return
            const popup = document.getElementById('popup')
            const attack = document.getElementById('attack')
            const defense = document.getElementById('defense')

            const draggingElement = document.querySelector('.dragging')
            const dropZone = ev.currentTarget
            console.log(dropZone)
            if(dropZone.children.length==0){
                popup.classList.remove('hidden')
                popup.classList.add('flex')
                const wave = document.createElement('div')
                wave.className = 'wave-effect'
                attack.onclick = () => {
                    // popup.classList.remove('flex')
                    popup.classList.add('hidden')
                    dropZone.appendChild(wave)
                    draggingElement.classList.add('card-drop-animation', 'w-[100%]')
                    dropZone.appendChild(draggingElement)
                    dropZone.classList.remove('border-2')
                    turn='defence'
                }
                defense.onclick = () => {
                    // popup.classList.remove('flex')
                    popup.classList.add('hidden')
                    dropZone.appendChild(wave)
                    draggingElement.classList.add('card-drop-animation', 'w-[100%]')
                    dropZone.appendChild(draggingElement)
                    dropZone.style.rotate = '90deg'
                    dropZone.classList.remove('border-2')
                    turn='defence'
                }
            }

        }

        function placeOpponentCard() {
            const opponentZones = document.querySelectorAll('#opponentCard > div');
            const emptyBoxs = [...opponentZones].filter(box => box.children.length === 0);
            console.log('emty boxs :', emptyBoxs.length)
          

            const randomBox = emptyBoxs[Math.floor(Math.random() * emptyBoxs.length)];
            console.log(randomBox)
            const randomCard = cards[Math.floor(Math.random() * cards.length)];
            console.log(randomCard)
            let chose = Math.floor(Math.random() * 2);


            const cardElement = document.createElement('div');
            cardElement.className = 'h-full w-full bg-gray-900 border-2 border-red-500 rounded-lg p-2';
            cardElement.innerHTML = `
            <img src="${randomCard.image}" class="w-full h-20 object-fit rounded mb-1">
            <p class="text-[9px] font-bold text-center">${randomCard.name}</p>
            <div class="flex justify-around text-[10px] text-gray-400 mt-1">
                <span>‚öîÔ∏è${randomCard.attack}</span>
                <span>üõ°Ô∏è${randomCard.defense}</span>
            </div>
        `;

            cardElement.style.transform = 'scale(0) translateY(-50px)';
            cardElement.style.opacity = '0';
            if(!chose){
                randomBox.style.rotate = '90deg'
            }
            randomBox.appendChild(cardElement);
            

            setTimeout(() => {
                cardElement.style.transition = 'all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1)';
                cardElement.style.transform = 'scale(1) translateY(0)';
                cardElement.style.opacity = '1';
            }, 10);
        }

        
        const endTurnBtn = document.querySelector('#endTurn');
        endTurnBtn.addEventListener('click', () => {
            if(turn=='defence'){
                placeOpponentCard();
                turn='player'
                play=1
            }

        });

        displayDeck(playCards);


        // displayDeck(playCards)
    </script>
</body>

</html>